<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Earthquake Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-search/dist/leaflet-search.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <style>
        #map { height: 600px; }
        #status-bar { 
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #f8f9fa;
            padding: 10px;
            box-shadow: 0px -2px 5px rgba(0,0,0,0.1);
        }
        #status-bar .info {
            display: inline-block;
            margin-right: 20px;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div id="status-bar">
        <span class="info" id="message">Loading data...</span>
        <span class="info" id="coordinates"></span>
    </div>
    <div class="container mt-4">
        <h2>Earthquake Information</h2>
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Location</th>
                        <th>Magnitude</th>
                        <th>Depth</th>
                        <th>Time</th>
                    </tr>
                </thead>
                <tbody id="earthquake-table-body">
                </tbody>
            </table>
        </div>
        <nav>
            <ul class="pagination justify-content-center" id="pagination">
            </ul>
        </nav>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-search/dist/leaflet-search.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script>
        const map = L.map('map').setView([0, 0], 2);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
        }).addTo(map);

        const searchControl = new L.Control.Search({
            position: 'topright',
            layer: L.layerGroup().addTo(map),
            initial: false,
            zoom: 10,
            marker: false
        }).addTo(map);

        function updateStatusMessage(message) {
            document.getElementById('message').textContent = message;
        }

        function updateCoordinates(lat, lon) {
            document.getElementById('coordinates').textContent = `Latitude: ${lat}, Longitude: ${lon}`;
        }

        function fetchData() {
            updateStatusMessage('Fetching data...');
            // Simulate fetching earthquake data from an API
            const data = [
                { id: 1, location: 'Location 1', magnitude: 4.5, depth: 10, time: '2024-06-17 00:00:00', lat: 37.77, lon: -122.42 },
                { id: 2, location: 'Location 2', magnitude: 5.2, depth: 20, time: '2024-06-17 00:05:00', lat: 34.05, lon: -118.25 },
                // Add more sample data as needed
            ];
            updateMap(data);
            updateTable(data);
            updateStatusMessage('Data loaded');
        }

        function updateMap(data) {
            const markers = [];
            data.forEach((item) => {
                const marker = L.marker([item.lat, item.lon]).addTo(map);
                marker.bindPopup(`<b>Location:</b> ${item.location}<br><b>Magnitude:</b> ${item.magnitude}<br><b>Depth:</b> ${item.depth}<br><b>Time:</b> ${item.time}`);
                markers.push(marker);
            });
            searchControl.setLayer(L.layerGroup(markers));
        }

        function updateTable(data) {
            const tableBody = document.getElementById('earthquake-table-body');
            tableBody.innerHTML = '';
            data.forEach((item, index) => {
                const row = `<tr>
                    <td>${index + 1}</td>
                    <td>${item.location}</td>
                    <td>${item.magnitude}</td>
                    <td>${item.depth}</td>
                    <td>${item.time}</td>
                </tr>`;
                tableBody.insertAdjacentHTML('beforeend', row);
            });
        }

        function updatePagination(total, currentPage = 1) {
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';
            const totalPages = Math.ceil(total / 10);
            for (let i = 1; i <= totalPages; i++) {
                const activeClass = i === currentPage ? 'active' : '';
                const pageItem = `<li class="page-item ${activeClass}"><a class="page-link" href="#">${i}</a></li>`;
                pagination.insertAdjacentHTML('beforeend', pageItem);
            }
        }

        map.on('mousemove', function (e) {
            updateCoordinates(e.latlng.lat.toFixed(4), e.latlng.lng.toFixed(4));
        });

        setInterval(fetchData, 300000); // 5 minutes interval
        fetchData(); // Initial data fetch
    </script>
</body>
</html>